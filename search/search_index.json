{"config":{"lang":["ja"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u671b\u6625\u5929","text":""},{"location":"cheetsheet/alpine/","title":"Alpine","text":""},{"location":"cheetsheet/alpine/#_1","title":"\u5176\u4ed6","text":"<pre><code># \u8fd0\u884c Golang \u4e8c\u8fdb\u5236\u7a0b\u5e8f\napk add gcompat\n</code></pre>"},{"location":"cheetsheet/docker/","title":"Docker","text":""},{"location":"cheetsheet/docker/#container","title":"Container","text":"<pre><code># \u5220\u9664\u6240\u6709\u5bb9\u5668\uff0c\u9664\u4e86 php \u548c nginx\ndocker rm $(docker ps -a | grep -Ewv \"php|nginx\" | awk 'NR&gt;1 {print $1}')\n</code></pre>"},{"location":"cheetsheet/docker/#volume","title":"Volume","text":"<pre><code># \u5220\u9664\u6240\u6709\u6ca1\u5728\u4f7f\u7528\u7684\u5377\ndocker volume prune\n</code></pre>"},{"location":"cheetsheet/docker/#image","title":"Image","text":"<pre><code># \u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u955c\u50cf\ndocker images --format \"{{.ID}}\\t{{.Size}}\\t{{.Repository}}:{{.Tag}}\" | sort -k 2 -h\n\n# \u6e05\u7406 none \u955c\u50cf\ndocker rmi $(docker images --filter \"dangling=true\" -q --no-trunc)\n# \u5220\u9664\u6240\u6709\u955c\u50cf\uff0c\u9664\u4e86 php \u548c alpine\ndocker rmi $(docker images -a | grep -Ewv 'php|alpine' | awk {'print $1'})\n</code></pre>"},{"location":"cheetsheet/mirror/","title":"Mirror","text":""},{"location":"cheetsheet/mirror/#ubuntu","title":"Ubuntu","text":"<pre><code>sed -i s@/archive.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list\nsed -i s@/security.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list\n</code></pre>"},{"location":"cheetsheet/mirror/#alpine","title":"Alpine","text":"<pre><code>sed -i 's/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g' /etc/apk/repositories\n</code></pre>"},{"location":"cheetsheet/mirror/#nodejs","title":"Node.js","text":"<pre><code>npm config set registry https://registry.npmmirror.com\n</code></pre>"},{"location":"cheetsheet/mirror/#python","title":"Python","text":"<pre><code>pip config set global.index-url http://mirrors.aliyun.com/pypi/simple/\n</code></pre>"},{"location":"cheetsheet/mirror/#go","title":"Go","text":"<pre><code>export GOPROXY=https://proxy.golang.com.cn,direct\n</code></pre>"},{"location":"cheetsheet/shell/","title":"Shell","text":""},{"location":"cheetsheet/shell/#grep","title":"grep","text":"<pre><code># \u5305\u542b\u4efb\u610f\u4e00\u4e2a\u5173\u952e\u5b57\ngrep -E 'google|youtube' file.txt\n</code></pre>"},{"location":"cheetsheet/ubuntu/","title":"Ubuntu","text":""},{"location":"cheetsheet/ubuntu/#user","title":"User","text":"<pre><code># \u52a0\u5165\u7ec4\nusermod -a -G sudo suhua\n</code></pre>"},{"location":"coredns/","title":"CoreOS","text":"<p>\u540c\u7c7b\u7684 DNS \u8fd8\u6709 dnsmasq\u3001bind \u7b49\u3002\u4e4b\u6240\u4ee5\u9009\u62e9 CoreDNS \u662f\u56e0\u4e3a\u5b83\u975e\u5e38\u8f7b\u4fbf\u548c\u6613\u7528\uff0c\u540c\u65f6\u4e5f\u662f\u4e3a\u4e86\u719f\u6089 Kubenetes \u7684\u8fd0\u4f5c\u3002</p>"},{"location":"coredns/client/","title":"\u5ba2\u6237\u7aef\u914d\u7f6e","text":""},{"location":"coredns/client/#kylin-v10","title":"Kylin V10","text":"<p>\u4fee\u6539 DNS \u914d\u7f6e</p> <pre><code># /etc/systemd/resolved.conf\n[Resolve]\nDNS=192.168.1.100\n</code></pre> <p>\u91cd\u542f\u670d\u52a1\u751f\u6548</p> <pre><code>sudo systemctl daemon-reload\nsudo systemctl restart systemd-resolved\n</code></pre>"},{"location":"coredns/install/","title":"\u5b89\u88c5","text":"<p>\u53ef\u4ee5\u4f7f\u7528 Docker \u6216\u8005\u4e8c\u8fdb\u5236\u65b9\u5f0f\u5b89\u88c5\uff0c\u4e2a\u4eba\u504f\u5411\u4e8e\u4f7f\u7528 Docker\uff0c\u5e76\u5728\u5b98\u65b9\u955c\u50cf\u57fa\u7840\u4e0a\u505a\u4e86\u5c01\u88c5\uff0c\u8be6\u89c1 aisuhua/docker-coredns\u3002</p>"},{"location":"coredns/install/#_2","title":"\u5b89\u88c5","text":"<pre><code>git clone git@github.com:aisuhua/docker-coredns.git\ncd docker-coredns\ndocker-compose up\n</code></pre>"},{"location":"coredns/install/#_3","title":"\u9a8c\u8bc1","text":"<pre><code>dig @127.0.0.1 master1.ocp1.example.com\ndig @127.0.0.1 -x 192.168.1.20\n</code></pre>"},{"location":"openshift/install/","title":"\u5b89\u88c5","text":"<p>\u672c\u6587\u8bb0\u5f55\u4e86\u5728\u79bb\u7ebf\u73af\u5883\u4e0b\u5b89\u88c5 OpenShift 4.8.36 \u7684\u5b8c\u6574\u6b65\u9aa4\u3002</p>"},{"location":"openshift/install/#_2","title":"\u524d\u63d0","text":"<p>\u8981\u5b8c\u6210\u5b89\u88c5 OpenShift\uff0c\u5fc5\u987b\u8981\u6709 DNS\u3001Chrony\u3001\u8d1f\u8f7d\u5747\u8861\u5668\uff08HAProxy\u3001Nginx \u7b49\uff09\u3001\u955c\u50cf\u4ed3\u5e93\uff08Harbor\uff09\u3002</p> <ol> <li>CoreDNS</li> </ol>"},{"location":"openshift/install/dns/","title":"\u6dfb\u52a0\u57df\u540d\u89e3\u6790","text":"<p>\u4e0b\u9762\u4ee5 CoreDNS \u4e3a\u4f8b\uff0c\u5176\u4ed6 DNS \u505a\u6cd5\u7c7b\u4f3c\u3002 </p>"},{"location":"openshift/install/dns/#_2","title":"\u6b63\u5411\u89e3\u6790","text":"<p>\u65b0\u5efa db.ocp1.example.com \u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b</p> <pre><code>$ORIGIN ocp1.example.com.\n@   3600 IN SOA example.com. example.com. (\n                2017042745 ; serial\n                7200       ; refresh (2 hours)\n                3600       ; retry (1 hour)\n                1209600    ; expire (2 weeks)\n                3600       ; minimum (1 hour)\n                )\n\n    3600 IN NS ns.example.com.\n\napi         IN A     192.168.1.10\napi-int     IN A     192.168.1.10\n\n*.apps      IN A     192.168.1.10\n\nbootstrap   IN A     192.168.1.10\n\nmaster1     IN A     192.168.1.20\nmaster2     IN A     192.168.1.21\nmaster3     IN A     192.168.1.22\n\nworker1     IN A     192.168.1.30\nworker2     IN A     192.168.1.31\nworker3     IN A     192.168.1.32\n</code></pre>"},{"location":"openshift/install/dns/#_3","title":"\u53cd\u5411\u89e3\u6790","text":"<p>\u65b0\u5efa db.1.168.192 \u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b</p> <pre><code>@   3600 IN SOA example.com. example.com. (\n                2017042745 ; serial\n                7200       ; refresh (2 hours)\n                3600       ; retry (1 hour)\n                1209600    ; expire (2 weeks)\n                3600       ; minimum (1 hour)\n                )\n\n    3600 IN NS ns.example.com.\n\n10     IN PTR     api.ocp1.example.com.\n10     IN PTR     api-int.ocp1.example.com.\n20     IN PTR     master1.ocp1.example.com.\n21     IN PTR     master2.ocp1.example.com.\n22     IN PTR     master3.ocp1.example.com.\n30     IN PTR     worker1.ocp1.example.com.\n31     IN PTR     worker2.ocp1.example.com.\n32     IN PTR     worker3.ocp1.example.com.\n</code></pre>"},{"location":"openshift/install/dns/#corefile","title":"\u914d\u7f6e\u5230 Corefile","text":"<pre><code>.:53 {\n    log\n    errors\n    cache\n\n    file db.ocp1.example.com ocp1.example.com\n    file db.1.168.192 1.168.192.in-addr.arpa\n}\n</code></pre>"},{"location":"openshift/install/dns/#_4","title":"\u68c0\u67e5\u914d\u7f6e","text":"<p>\u8fd0\u884c\u4ee5\u4e0b\u811a\u672c\u68c0\u67e5 DNS \u662f\u5426\u90fd\u914d\u7f6e\u6b63\u786e</p> <pre><code>#/bin/bash\nDNS_IP=127.0.0.1\n\ndeclare -A arr\narr[api.ocp1.example.com]=192.168.1.10\narr[api-int.ocp1.example.com]=192.168.1.10\narr[a.apps.ocp1.example.com]=192.168.1.10\narr[master1.ocp1.example.com]=192.168.1.20\narr[master2.ocp1.example.com]=192.168.1.21\narr[master3.ocp1.example.com]=192.168.1.22\narr[worker1.ocp1.example.com]=192.168.1.30\narr[worker2.ocp1.example.com]=192.168.1.31\narr[worker3.ocp1.example.com]=192.168.1.32\n\nfor key in \"${!arr[@]}\"; do ip=$(dig @$DNS_IP +short $key)\nif [ \"$ip\" != \"${arr[$key]}\" ]; then\necho \"$key is ${arr[$key]}, result $ip\"\nfi\ndomain=$(dig @$DNS_IP +short -x ${arr[$key]})\nif [[ $key == a.* ]]; then\ncontinue\nfi\nif [[ $key == api* ]]; then\ndomains=($domain)\nif [[ ! \"${domains[*]}\" =~ \"${key}\" ]]; then\necho \"${arr[$key]} is $key, result ${array[*]}\"\nfi\nelse\nif [[ ! \"$domain\" == \"$key.\" ]]; then\necho \"${arr[$key]} is $key, result $domain\"\nfi\nfi\ndone\n</code></pre>"},{"location":"openshift/install/download/","title":"\u51c6\u5907\u5b89\u88c5\u4ecb\u8d28","text":""},{"location":"openshift/install/download/#_2","title":"\u9700\u8981\u7684\u4ecb\u8d28","text":"<ol> <li>OpenShift \u5b89\u88c5\u811a\u672c openshift-install-linux-4.8.36.tar.gz</li> <li>OpenShift oc \u5ba2\u6237\u7aef openshift-client-linux-4.8.36.tar.gz </li> <li>CoreOS \u5b89\u88c5\u5149\u76d8 rhcos-4.8.14-x86_64-live.x86_64.iso</li> <li>machine configs \u751f\u6210\u5de5\u5177 butane</li> <li>OpenShift \u5b89\u88c5\u955c\u50cf 4.8.36_releases</li> <li>\u4e00\u4e2a 4G+ \u7684 U \u76d8\uff0c\u7528\u4e8e\u523b\u5f55\u5b89\u88c5\u5149\u76d8</li> </ol> <p>\u4ee5\u4e0a\u4ecb\u8d28\uff0c\u9664\u4e86\u4e0b\u8f7d OpenShift \u5b89\u88c5\u955c\u50cf\u9700\u8981\u767b\u5f55\uff0c\u5176\u4ed6\u4ecb\u8d28\u90fd\u53ef\u4ee5\u5728\u516c\u7f51\u76f4\u63a5\u4e0b\u8f7d\u3002</p>"},{"location":"openshift/install/download/#_3","title":"\u4e0b\u8f7d\u5b89\u88c5\u955c\u50cf","text":"<p>\u4ee5\u4e0b\u6b65\u9aa4\u5c06\u4e0b\u8f7d OpenShift \u5b89\u88c5\u955c\u50cf\u5230\u672c\u5730\u78c1\u76d8\uff0c\u955c\u50cf\u6bd4\u8f83\u5927\uff0c\u8bf7\u9884\u7559\u81f3\u5c11 20GB \u7a7a\u95f4\u3002</p> <p>Note</p> <p>\u56e0\u4e3a\u9700\u8981\u4ece\u7ea2\u5e3d\u5b98\u7f51\u4e0b\u8f7d\u955c\u50cf\uff0c\u5982\u679c\u7528\u4e2a\u4eba\u7535\u8111\u4e0b\u8f7d\uff0c\u901f\u5ea6\u4f1a\u6bd4\u8f83\u6162\uff0c\u800c\u4e14\u7ecf\u5e38\u4e2d\u65ad\uff0c \u6240\u4ee5\u5efa\u8bae\u4f7f\u7528\u56fd\u5185\u7684\u4e91\u670d\u52a1\u5668\uff08\u4f8b\u5982\uff1a\u963f\u91cc\u4e91\u3001\u817e\u8baf\u4e91\u7b49\uff09\u8fdb\u884c\u4e0b\u8f7d\u3002</p>"},{"location":"openshift/install/download/#oc","title":"\u5b89\u88c5 oc \u5ba2\u6237\u7aef","text":"<pre><code>tar -zxvf openshift-client-linux-4.8.36.tar.gz -C /usr/local/bin oc kubectl\n</code></pre>"},{"location":"openshift/install/download/#pull-secerttxt","title":"\u83b7\u53d6 pull-secert.txt","text":"<p>\u6253\u5f00 https://console.redhat.com/openshift/install/pull-secret \u9875\u9762\uff0c\u4f7f\u7528\u8d26\u53f7\u767b\u5f55\u540e\u4e0b\u8f7d\u3002\u5982\u679c\u4f60\u6ca1\u6709\u8d26\u53f7\u53ef\u81ea\u884c\u6ce8\u518c\u3002</p>"},{"location":"openshift/install/download/#_4","title":"\u5c06\u955c\u50cf\u540c\u6b65\u5230\u672c\u5730","text":"<pre><code>oc adm release mirror -a pull-secret.txt 4.8.36 --to-dir ./4.8.36_release\n</code></pre> <p>Info</p> <p>\u4e0b\u8f7d\u5176\u4ed6\u7248\u672c\u7684\u955c\u50cf\u8bf7\u4fee\u6539 <code>4.8.36</code> \u7248\u672c\u53f7\uff0c<code>oc adm release mirror --help</code> \u67e5\u770b\u66f4\u591a\u4f7f\u7528\u65b9\u6cd5\u3002 </p>"},{"location":"openshift/install/download/#_5","title":"\u6253\u5305\u955c\u50cf\u6587\u4ef6\u5939","text":"<pre><code>tar -cvf 4.8.36_release.tar 4.8.36_release\n</code></pre>"},{"location":"openshift/install/download/#_6","title":"\u5236\u4f5c\u542f\u52a8\u76d8","text":"<pre><code>dd if=rhcos-4.8.14-x86_64-live.x86_64.iso of=&lt;dev/sdx&gt; status=progress\n</code></pre> <p>Note</p> <p>CoreOS \u5b89\u88c5\u955c\u50cf\u7684\u7248\u672c\u4e0d\u80fd\u9ad8\u8fc7\u73b0\u5728\u6b63\u5728\u5b89\u88c5\u7684 OpenShift \u7684\u7248\u672c\u3002</p>"},{"location":"openshift/install/download/#_7","title":"\u53c2\u8003","text":"<ol> <li>Mirroring the OpenShift Container Platform image repository</li> <li>Installing with USB media</li> </ol>"},{"location":"openshift/install/lb/","title":"\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861","text":"<p>TODO</p>"},{"location":"openshift/solutions/mcp-auto-update/","title":"MCP \u81ea\u52a8\u66f4\u65b0","text":"<p>\u5b98\u65b9\u5efa\u8bae MCP \u5e94\u8be5\u4fdd\u6301\u5f00\u542f\u72b6\u6001\u3002\u56e0\u4e3a\u4ece 4.7.4 \u7248\u672c\u5f00\u59cb\uff0capi-server \u8bc1\u4e66\u81ea\u52a8\u8f6e\u8f6c\u4e0d\u4f1a\u518d\u89e6\u53d1\u8282\u70b9\u91cd\u542f\uff0c\u800c\u5173\u95ed\u81ea\u52a8\u66f4\u65b0\u5219\u4f1a\u5bfc\u81f4\u8bc1\u4e66\u65e0\u6cd5\u6b63\u5e38\u66f4\u65b0\u3002</p> <p>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u5f00\u542f MCP \u81ea\u52a8\u66f4\u65b0 </p> <pre><code>oc patch --type merge machineconfigpool/master -p '{\"spec\":{\"paused\":false}}'\noc patch --type merge machineconfigpool/worker -p '{\"spec\":{\"paused\":false}}'\n</code></pre>"},{"location":"openshift/solutions/mcp-auto-update/#_1","title":"\u53c2\u8003","text":"<ol> <li>Understand CA cert auto renewal in Red Hat OpenShift 4</li> <li>Disabling the Machine Config Operator from automatically rebooting by using the console</li> </ol>"},{"location":"ssl/import-ca/","title":"\u5bfc\u5165\u8bc1\u4e66","text":""},{"location":"ssl/import-ca/#ubuntu","title":"Ubuntu","text":"<pre><code>sudo apt-get install -y ca-certificates\nsudo cp local-ca.crt /usr/local/share/ca-certificates\nsudo update-ca-certificates\n</code></pre>"}]}